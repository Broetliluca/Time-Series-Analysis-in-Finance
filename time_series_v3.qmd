---
title: "Time Series Analysis in Finance"
subtitle: "How do changes in EU ETS carbon allowance prices affect the returns of sustainable ETFs compared to carbon-intensive ETFs"
author:
  - name: "Luca Signorini"
  - name: "Mattia Bettoja"
date: "`r format(Sys.Date(), '%Y-%m-%d')`"
format:
  html:
    theme: journal
    toc: true
    toc-depth: 3
    toc-floating: true
    df-print: paged
execute:
  echo: true
  warning: false
  message: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE
)

# Data Load & Reprocessing
library(tidyverse)
library(readr)
library(lubridate)
library(zoo)
library(tseries)
library(vars)
library(rugarch)
library(corrplot)
library(lmtest)

# EDA
library(dplyr)
library(tidyr)
library(ggplot2)
library(moments)

# Volatility Diagnostics
library(FinTS)
```

# 1. Introduction

This project investigates how **EU ETS carbon allowance prices** influence the performance of two ETFs:

-   **Sustainable ETF:** iShares MSCI Europe *Paris-Aligned Climate*\
    → expected to be less exposed to rising carbon prices

-   **Carbon-intensive ETF:** iShares STOXX Europe 600 *Oil & Gas*\
    → expected to react negatively to rising carbon prices

The goal is to compare **returns, relationships, and volatility patterns** across these series.

# 2. Background

## 2.1 EU ETS Carbon Prices

EU ETS allowances represent the right to emit one tonne of CO₂. Prices fluctuate based on supply, policy changes, and industrial demand.

[Source](https://www.blackrock.com/uk/individual/products/318925/ishares-msci-europe-paris-aligned-climate-ucits-etf){target="\_blank"} (https://icapcarbonaction.com/en/ets-prices)

## 2.2 Paris-Aligned Climate ETF

Tracks companies aligned with the Paris climate transition pathway. Expected to be less carbon-sensitive.

[Source](https://www.blackrock.com/uk/individual/products/318925/ishares-msci-europe-paris-aligned-climate-ucits-etf){target="\_blank"} (https://www.blackrock.com/uk/individual/products/318925/ishares-msci-europe-paris-aligned-climate-ucits-etf)

## 2.3 Oil & Gas ETF

Tracks fossil-fuel-intensive companies whose profitability depends heavily on carbon exposure.

[Source](https://www.ishares.com/ch/privatkunden/de/produkte/251954/ishares-stoxx-europe-600-oil-gas-ucits-etf-de-fund#/){target="\_blank"} (https://www.ishares.com/ch/privatkunden/de/produkte/251954/ishares-stoxx-europe-600-oil-gas-ucits-etf-de-fund#/)

# 3. Method Overview

We apply fundamental time series steps:

- **Import data**
- **Clean & merge datasets**
- **Compute log-returns**
- **Exploratory data analysis (EDA)**
- **Time Series Diagnostics**
- **Check for relationship by applying Granger Causality Tests**
- **Volatility Diagnostics by applying GARCH and GARCH-X Tests**

# 4. Data Loading & Preprocessing

## 4.1 Load datasets from GitHub

```{r load}
base <- "https://raw.githubusercontent.com/Broetliluca/Time-Series-Analysis-in-Finance/main/.csv%20Data/"

url_eua <- paste0(base, "icap-graph-price-data-2019-01-07-2025-11-20.csv")
url_pa  <- paste0(base, "iShares-MSCI-Europe-Paris-Aligned-Climate-UCITS-ETF-EUR-Acc_fund.csv")
url_oil <- paste0(base, "STOXX-Europe-600-Oil--Gas-UCITS-ETF-DE_fund.csv")

eua_raw  <- read_csv(url_eua, show_col_types = FALSE)
pa_raw   <- read_csv(url_pa,  show_col_types = FALSE)
oil_raw  <- read_csv(url_oil, show_col_types = FALSE)
```

------------------------------------------------------------------------

## 4.2 Clean EUA carbon price data

Structure confirmed:

-   First row = metadata\
-   Columns: `Date_raw`, `Primary`, `Secondary`, others

```{r clean_eua}
# Ensure tibble format
eua_raw <- as_tibble(eua_raw)

# Remove first descriptive row safely
eua_tmp <- eua_raw %>% slice(-1)

# Clean EUA data
eua_clean <- eua_tmp %>%
  rename(
    Date_raw  = `...1`,
    Primary   = `...5`,
    Secondary = `...6`
  ) %>%
  mutate(
    Date      = as.Date(Date_raw),
    Primary   = suppressWarnings(parse_number(Primary)),
    Secondary = suppressWarnings(parse_number(Secondary)),
    EUA_Price = if_else(!is.na(Primary), Primary, Secondary)
  ) %>%
  dplyr::select(Date, EUA_Price) %>%
  arrange(Date)

head(eua_clean)

```

------------------------------------------------------------------------

## 4.3 Clean Paris-Aligned ETF data

This dataset is *semicolon-separated inside a single column*.

```{r clean_pa}
# Ensure PA data is a tibble
pa_raw <- as_tibble(pa_raw)

# Split the single-column format
pa_tmp <- pa_raw %>%
  separate(
    col = 1,
    into = c("Date_raw","Currency","NAV","Shares","Assets","FundRet","BenchRet"),
    sep = ";",
    fill = "right",
    extra = "merge"
  )

# Clean
pa_clean <- pa_tmp %>%
  mutate(
    Date_raw = str_replace(Date_raw, "\\.", "/"),
    Date     = suppressWarnings(dmy(Date_raw)),
    NAV      = suppressWarnings(parse_number(NAV))
  ) %>%
  dplyr::select(Date, PA_NAV = NAV) %>%
  filter(!is.na(Date)) %>%
  arrange(Date)

head(pa_clean)
```

------------------------------------------------------------------------

## 4.4 Clean Oil & Gas ETF data

Same semicolon-separated structure.

```{r clean_oil}
# Ensure tibble
oil_raw <- as_tibble(oil_raw)

# Split single-column format
oil_tmp <- oil_raw %>%
  tidyr::separate(
    col  = 1,
    into = c("Date_raw","Currency","NAV","Shares","Assets","FundRet","BenchRet"),
    sep  = ";",
    fill = "right",
    extra = "merge"
  )

# Clean OIL ETF data
oil_clean_full <- oil_tmp %>%
  dplyr::mutate(
    # Trim whitespace
    Date_raw = stringr::str_trim(Date_raw),

    # Fix missing dot before the year (Juli2025 → Juli.2025)
    Date_raw = stringr::str_replace(Date_raw,
                                    "([A-Za-zäöüÄÖÜ]+)([0-9]{4})", 
                                    "\\1.\\2"),

    # Replace all dots with slashes (31.Juli.2025 → 31/Juli/2025)
    Date_str = stringr::str_replace_all(Date_raw, "\\.", "/"),

    # Parse with German locale because of month names like "Juli"
    Date     = suppressWarnings(lubridate::dmy(Date_str, locale = "de_DE")),

    # Parse NAV
    NAV_num  = suppressWarnings(readr::parse_number(NAV))
  ) %>%
  dplyr::filter(!is.na(Date)) %>%  # <-- REQUIRED: remove invalid parsed rows
  dplyr::arrange(Date)


# Keep only Date + NAV
oil_clean <- oil_clean_full[, c("Date", "NAV_num")]
names(oil_clean)[2] <- "OIL_NAV"

# Check Parseing
sum(is.na(oil_clean$Date))

head(oil_clean)

```

------------------------------------------------------------------------

## 4.5 Align overlapping date range & merge datasets

```{r merge}
start_date <- max(
  min(eua_clean$Date, na.rm = TRUE),
  min(pa_clean$Date,  na.rm = TRUE),
  min(oil_clean$Date, na.rm = TRUE)
)

end_date <- min(
  max(eua_clean$Date, na.rm = TRUE),
  max(pa_clean$Date,  na.rm = TRUE),
  max(oil_clean$Date, na.rm = TRUE)
)

# Filter each series to the common window
eua_f <- eua_clean %>% dplyr::filter(Date >= start_date, Date <= end_date)
pa_f  <- pa_clean  %>% dplyr::filter(Date >= start_date, Date <= end_date)
oil_f <- oil_clean %>% dplyr::filter(Date >= start_date, Date <= end_date)

# Merge step by step
merged <- eua_f %>%
  dplyr::inner_join(pa_f,  by = "Date") %>%
  dplyr::inner_join(oil_f, by = "Date") %>%
  dplyr::arrange(Date)

head(merged)
```

------------------------------------------------------------------------

## 4.6 Compute log-returns

```{r returns}
returns <- merged %>%
  dplyr::mutate(
    EUA_ret = log(EUA_Price / dplyr::lag(EUA_Price)),
    PA_ret  = log(PA_NAV    / dplyr::lag(PA_NAV)),
    OIL_ret = log(OIL_NAV   / dplyr::lag(OIL_NAV))
  ) %>%
  tidyr::drop_na()

head(returns)
```

------------------------------------------------------------------------

# 5. Exploratory Data Analysis (EDA)

## 5.1 Summary statistics

```{r, stats, cache=TRUE}
# Calculate main Statistic measurements
stats_tbl <- returns %>%
  summarise(
    mean_EUA = mean(EUA_ret),
    sd_EUA   = sd(EUA_ret),
    skew_EUA = skewness(EUA_ret),
    kurt_EUA = kurtosis(EUA_ret),

    mean_PA = mean(PA_ret),
    sd_PA   = sd(PA_ret),
    skew_PA = skewness(PA_ret),
    kurt_PA = kurtosis(PA_ret),

    mean_OIL = mean(OIL_ret),
    sd_OIL   = sd(OIL_ret),
    skew_OIL = skewness(OIL_ret),
    kurt_OIL = kurtosis(OIL_ret)
  )

# Transpose the Table
stats_tbl_tidy <- stats_tbl %>%
  pivot_longer(cols = everything(),
               names_to = c("stat", "asset"),
               names_sep = "_") %>%
  pivot_wider(names_from = asset, values_from = value) %>%
  rename(
    Statistic = stat,
    EUA = EUA,
    PA = PA,
    OIL = OIL
  )

stats_tbl_tidy # Print Table
```
The high standard deviation and excess kurtosis of EUA returns reflect the speculative and policy-driven nature of the carbon market. Both ETFs display lower volatility, but the Oil & Gas ETF exhibits higher tail risk than the Paris-Aligned ETF.

------------------------------------------------------------------------

## 5.2 Time series plot of returns

```{r, plot_returns, cache=TRUE}
# Price levels single and merged
eua_clean %>%
  dplyr::filter(Date >= as.Date("2021-07-27")) %>%
  dplyr::select(Date, EUA_Price) %>%
  ggplot(aes(Date, EUA_Price)) +
  geom_line(color = "firebrick") +
  labs(
    title = "EUA Carbon Price Time Series (Raw)",
    y = "EUA Price",
    x = "Date"
  ) +
  theme_minimal()

pa_clean %>%
  dplyr::filter(Date >= as.Date("2021-07-27")) %>%
  dplyr::select(Date, PA_NAV) %>%
  ggplot(aes(Date, PA_NAV)) +
  geom_line(color = "steelblue") +
  labs(
    title = "Paris-Aligned ETF Time Series (Raw)",
    y = "NAV",
    x = "Date"
  ) +
  theme_minimal()

oil_clean %>%
  dplyr::filter(Date >= as.Date("2021-07-27")) %>%
  dplyr::select(Date, OIL_NAV) %>%
  ggplot(aes(Date, OIL_NAV)) +
  geom_line(color = "darkgreen") +
  labs(
    title = "Oil & Gas ETF Time Series (Zoom: 2021–Present)",
    y = "NAV",
    x = "Date"
  ) +
  theme_minimal()

merged %>%
  dplyr::select(Date, EUA_Price, PA_NAV, OIL_NAV) %>%
  pivot_longer(-Date) %>%
  ggplot(aes(Date, value, color = name)) +
  geom_line() +
  labs(title = "Price Levels: EUA Carbon Price, Paris-Aligned ETF, Oil & Gas ETF",
       y = "Price / NAV",
       x = "Date")


# Returns
returns %>%
  dplyr::select(Date, EUA_ret, PA_ret, OIL_ret) %>%
  tidyr::pivot_longer(-Date, names_to = "Series", values_to = "Return") %>%
  ggplot(aes(Date, Return, color = Series)) +
  geom_line(alpha = 0.7) +
  labs(
    title = "Daily Log Returns: EUA vs. Paris-Aligned ETF vs. Oil & Gas ETF",
    x = "Date",
    y = "Log Return"
  ) +
  theme_minimal()

```
The three price series evolve very differently over time. EUA carbon prices are highly volatile, while both ETFs display smoother price dynamics, with the Paris-Aligned ETF being the most stable.

Daily returns of all three series fluctuate around zero with no visible long-term trend. EUA returns exhibit much larger spikes than ETF returns, indicating higher short-term risk.

------------------------------------------------------------------------

## 5.3 Rolling 30-day volatility

```{r, rolling, cache=TRUE}
# Compute daily log-returns
returns <- merged %>%
  dplyr::mutate(
    EUA_ret = log(EUA_Price / dplyr::lag(EUA_Price)),
    PA_ret  = log(PA_NAV    / dplyr::lag(PA_NAV)),
    OIL_ret = log(OIL_NAV   / dplyr::lag(OIL_NAV))
  ) %>%
  tidyr::drop_na()

# Compute 30-day rolling volatility
returns_rolling <- returns %>%
  dplyr::mutate(
    vol_EUA = zoo::rollapply(EUA_ret, width = 30, FUN = sd, fill = NA, align = "right"),
    vol_PA  = zoo::rollapply(PA_ret,  width = 30, FUN = sd, fill = NA, align = "right"),
    vol_OIL = zoo::rollapply(OIL_ret, width = 30, FUN = sd, fill = NA, align = "right")
  )

# Plot rolling volatility
returns_rolling %>%
  dplyr::select(Date, vol_EUA, vol_PA, vol_OIL) %>%
  tidyr::pivot_longer(-Date, names_to = "Series", values_to = "Volatility") %>%
  ggplot(aes(Date, Volatility, color = Series)) +
  geom_line() +
  labs(
    title = "Rolling 30-Day Volatility (Standard Deviation of Daily Log Returns)",
    y = "Volatility (σ)",
    x = "Date"
  ) +
  theme_minimal()

```
Rolling volatility measures short-term risk dynamics by smoothing daily returns over a fixed window (here: ~1 trading month).

EUA carbon prices exhibit the highest and most unstable volatility, while the Paris-Aligned ETF consistently shows the lowest volatility. The Oil & Gas ETF lies in between but displays longer periods of elevated risk.

------------------------------------------------------------------------

## 5.4 Correlation matrix

```{r corrmatrix, cache=TRUE}
corr_mat <- cor(returns[, c("EUA_ret","PA_ret","OIL_ret")])

corrplot::corrplot(corr_mat, method="color", addCoef.col="black")

```

The correlation matrix shows that daily EUA carbon price returns have almost no linear relationship with either the Paris-Aligned ETF or the Oil & Gas ETF (correlations ≈ 0.09). This suggests that short-term carbon price fluctuations do not immediately affect equity performance in either sector.

In contrast, the Paris-Aligned ETF and the Oil & Gas ETF exhibit a moderate correlation of 0.45, reflecting their shared exposure to broader equity market movements. These results imply that carbon prices operate somewhat independently from daily stock market dynamics and support the need for more advanced dynamic models such as VAR or Granger causality to detect potential lagged effects.

# 6. Time Series Diagnostics

Before modeling anything, we verify whether the series can be used in VAR, Granger, and GARCH by checking for Stationarity.

```{r, time series diagnostic, cache=TRUE}

adf_EUA  <- adf.test(returns$EUA_ret)
adf_PA   <- adf.test(returns$PA_ret)
adf_OIL  <- adf.test(returns$OIL_ret)

adf_EUA
adf_PA
adf_OIL

```
The ADF test rejects the presence of a unit root for all return series, confirming stationarity and validating the application of VAR, Granger causality, and GARCH models.

# 7. Relationship Tests

**Do changes in carbon prices cause changes in ETF returns?**
The central research question of this study is whether movements in EU ETS carbon allowance prices lead to systematic changes in the returns of sustainable and carbon-intensive ETFs. To examine this, we focus on dynamic lead–lag relationships rather than simple correlations.

Specifically, we apply Granger causality tests within a Vector Autoregression (VAR) framework. Granger causality does not imply true economic causation; instead, it tests whether past values of one variable contain statistically significant information for predicting another variable, beyond what is already contained in its own past.

In this context, we examine whether lagged carbon price returns help predict:

returns of the Oil & Gas ETF, representing carbon-intensive assets, and

returns of the Paris-Aligned ETF, representing sustainable assets.

If carbon pricing is an important driver of financial performance, we would expect EUA returns to Granger-cause ETF returns—particularly for the carbon-intensive Oil & Gas ETF, which is more directly exposed to regulatory and transition risk.

At the same time, we also test for instantaneous causality, which captures contemporaneous relationships between markets. A significant instantaneous effect would indicate that carbon and equity markets respond simultaneously to common shocks, rather than through delayed transmission.

By combining Granger causality tests with impulse response analysis, this section assesses whether carbon prices act as a leading indicator, a coincident indicator, or have no dynamic influence on ETF returns at the daily frequency.

------------------------------------------------------------------------

## 7.1 Granger Causality: EUA -> Oil & Gas ETF

*Using daily data, we allow for up to ten lags (approximately two trading weeks) and select the optimal lag length via the Akaike Information Criterion, which is standard in high-frequency financial applications.*

```{r, ganger causality eua-oil&gas, cache=TRUE}

lag_oil <- VARselect(returns[, c("EUA_ret","OIL_ret")], lag.max = 10)$selection["AIC(n)"]

var_oil <- VAR(returns[, c("EUA_ret","OIL_ret")], p = lag_oil)

causality(var_oil, cause = "EUA_ret")

```
The Granger causality test finds no evidence of lagged causal effects from EUA carbon price returns to Oil & Gas ETF returns, while the significant instantaneous causality suggests that both markets respond contemporaneously to common external shocks rather than exhibiting a predictive lead–lag relationship.

------------------------------------------------------------------------

## 7.2 Granger Causality: EUA -> Paris Aligned ETF

```{r, ganger causality eua-parisaligned, cache=TRUE}

lag_pa <- VARselect(returns[, c("EUA_ret","PA_ret")], lag.max = 10)$selection["AIC(n)"]

var_pa <- VAR(returns[, c("EUA_ret","PA_ret")], p = lag_pa)

causality(var_pa, cause = "EUA_ret")

```
Neither ETF shows Granger causality from carbon prices, meaning carbon price changes do not lead ETF returns over time.

The Granger causality tests provide no statistical evidence of lagged causal effects from EUA carbon price returns to either the Oil & Gas ETF or the Paris-Aligned ETF. This indicates that changes in carbon prices do not systematically precede or predict ETF returns at the daily frequency.

However, both ETFs exhibit significant instantaneous causality with EUA returns, suggesting that carbon and equity markets tend to react contemporaneously to common information or shocks, such as macroeconomic news, energy market developments, or policy announcements. In this sense, carbon prices appear to function as a coincident indicator rather than a leading driver of equity returns.

To further examine the dynamic response of ETF returns to carbon price shocks and to assess whether any short-term effects emerge beyond the Granger framework, we next analyze impulse response functions derived from the estimated VAR models.

------------------------------------------------------------------------

## 7.3 Impuls Responses

```{r, impuls respons, cache=TRUE}
# Impuls Response Plot: EUA -> Oil & Gas ETF
irf_oil <- irf(
  var_oil,
  impulse  = "EUA_ret",
  response = "OIL_ret",
  boot     = TRUE,
  n.ahead  = 10
)

plot(irf_oil)

# Impuls Response Plot: EUA -> Paris Aligned ETF
irf_pa <- irf(
  var_pa,
  impulse  = "EUA_ret",
  response = "PA_ret",
  boot     = TRUE,
  n.ahead  = 10
)

plot(irf_pa)

```
How to read this plot

- **x-axis:** days after a one-standard-deviation shock to EUA returns
- **solid line:** estimated response of OIL returns
- **dashed lines:** 95% confidence bands

The impulse response functions show that shocks to EUA carbon price returns do not generate statistically significant or persistent responses in either the Oil & Gas ETF or the Paris-Aligned ETF. Any short-run movements remain within the confidence bands and quickly revert to zero. This visual evidence supports the Granger causality results and indicates that carbon price shocks do not dynamically transmit into ETF returns over time, reinforcing the interpretation that observed relationships are primarily contemporaneous rather than predictive.


# 8. Volatility Diagnostics

Although the Granger causality and impulse response results show that changes in carbon prices do not predict ETF returns over time, this does not mean that carbon prices have no impact at all. Financial markets often react to regulatory and policy uncertainty not through immediate changes in returns, but through changes in risk and uncertainty.

In other words, carbon price movements may increase or decrease how volatile ETF returns are, even if they do not systematically raise or lower returns themselves. GARCH models are therefore used to examine whether carbon price dynamics are linked to persistent changes in volatility across assets. This helps distinguish between effects on expected returns and effects on risk.

## 8.1 ARCH Test (Volatility Clustering)

```{r, ARCH Test, cache=TRUE}

ArchTest(returns$EUA_ret)
ArchTest(returns$PA_ret)
ArchTest(returns$OIL_ret)

```
The ARCH LM test strongly rejects homoskedasticity for all return series, confirming volatility clustering and justifying the use of GARCH models.

------------------------------------------------------------------------

## 8.2 GARCH(1,1) Estimation

Before explicitly testing whether carbon prices affect ETF volatility, we first estimate standard GARCH(1,1) models for each return series to characterize their intrinsic volatility dynamics. The aim of this step is not to explain volatility through external drivers, but to assess whether returns exhibit volatility clustering and persistence, which are common features of financial time series.

By estimating the GARCH parameters, we examine:

how strongly volatility reacts to new shocks (α),

how persistent volatility is over time (β), and

whether periods of elevated risk tend to decay quickly or remain prolonged (α + β).

This baseline analysis provides a benchmark for comparing risk dynamics across carbon prices, sustainable assets, and carbon-intensive assets, and it establishes whether more advanced volatility models—such as GARCH-X specifications including carbon prices—are empirically justified.

```{r, GARCH Test, cache=TRUE}

# 1️⃣ Specify GARCH(1,1) model
spec <- ugarchspec(
  variance.model = list(model = "sGARCH", garchOrder = c(1,1)),
  mean.model     = list(armaOrder = c(0,0), include.mean = TRUE),
  distribution.model = "norm"
)

# 2️⃣ Fit models
garch_EUA  <- ugarchfit(spec, returns$EUA_ret)
garch_PA   <- ugarchfit(spec, returns$PA_ret)
garch_OIL  <- ugarchfit(spec, returns$OIL_ret)

# 3️⃣ Extract key parameters
extract_garch <- function(fit, asset) {
  coefs <- coef(fit)
  tibble(
    Asset       = asset,
    Alpha       = coefs["alpha1"],
    Beta        = coefs["beta1"],
    Persistence = coefs["alpha1"] + coefs["beta1"]
  )
}

garch_table <- bind_rows(
  extract_garch(garch_EUA, "EUA Carbon Price"),
  extract_garch(garch_PA,  "Paris-Aligned ETF"),
  extract_garch(garch_OIL, "Oil & Gas ETF")
) %>%
  mutate(across(c(Alpha, Beta, Persistence), round, 3))

# 4️⃣ Display results table
knitr::kable(
  garch_table,
  caption = "GARCH(1,1) Volatility Persistence Across Assets"
)

```
**Interpretation of GARCH output**
The key parameters are:

- α (alpha) → short-term reaction to shocks
- β (beta) → persistence of volatility over time
- α + β → overall volatility persistence

close to 1 → very persistent volatility (long-lasting risk)

**EUA carbon price volatility**

- α = 0.184
- β = 0.785
- α + β ≈ 0.97

EUA returns exhibit strong volatility clustering and high persistence. Shocks to carbon prices increase volatility, and this elevated volatility decays only slowly over time. This reflects the policy-driven and regulatory nature of the carbon market, where uncertainty tends to persist.

**Paris-Aligned ETF volatility**

- α = 0.198
- β = 0.695
- α + β ≈ 0.89

The Paris-Aligned ETF shows moderate volatility persistence, lower than that of EUA prices and the Oil & Gas ETF. While volatility responds to shocks, it dissipates more quickly. This suggests that sustainable assets are less exposed to prolonged uncertainty, consistent with their diversified and lower-carbon structure. So volatility clustering is present but less pronounced.

**Oil & Gas ETF volatility**

- α = 0.041
- β = 0.943
- α + β ≈ 0.98

The Oil & Gas ETF exhibits extremely high volatility persistence. Although volatility reacts less strongly to immediate shocks (low α), once volatility increases, it remains elevated for a long time (very high β). This can be seen also very clearly in the following plots where line goes slowly down after a sharp rising of volatility.

This indicates that carbon-intensive assets are highly sensitive to prolonged periods of uncertainty, even if short-term reactions are muted. This is consistent with exposure to regulatory risk, energy price uncertainty, and macroeconomic shocks.


```{r, GARCH volatility Plots}

vol_df <- tibble(
  Date = returns$Date,
  EUA  = sigma(garch_EUA),
  PA   = sigma(garch_PA),
  OIL  = sigma(garch_OIL)
)

y_lim <- c(0, 0.09)

# EUA volatility
ggplot(vol_df, aes(Date, EUA)) +
  geom_line(color = "steelblue") +
  scale_y_continuous(limits = y_lim) +
  labs(
    title = "Conditional Volatility – EUA Carbon Prices",
    y = "Volatility (σ)",
    x = "Date"
  ) +
  theme_minimal()

# Paris-Aligned ETF volatility
ggplot(vol_df, aes(Date, PA)) +
  geom_line(color = "steelblue") +
  scale_y_continuous(limits = y_lim) +
  labs(
    title = "Conditional Volatility – Paris-Aligned ETF",
    y = "Volatility (σ)",
    x = "Date"
  ) +
  theme_minimal()

# Oil & Gas ETF volatility
ggplot(vol_df, aes(Date, OIL)) +
  geom_line(color = "steelblue") +
  scale_y_continuous(limits = y_lim) +
  labs(
    title = "Conditional Volatility – Oil & Gas ETF",
    y = "Volatility (σ)",
    x = "Date"
  ) +
  theme_minimal()
```

**How to read the plots:**

Y-axis: Volatility (σ)

This is the conditional volatility estimated by a GARCH(1,1) model.
It measures risk / uncertainty, not returns.

Example interpretation:
- σ = 0.02 → about 2% daily volatility
- σ = 0.01 → about 1% daily volatility

------------------------------------------------------------------------

## 8.3 GARCH-X: Carbon Price Effects on ETF Volatility

We extend the GARCH(1,1) model by including EUA carbon price returns as an exogenous variable in the variance equation to test whether carbon prices directly affect ETF volatility.

```{r, GARCH-X EUA effect on ETF Volatility, cache=TRUE}
# GARCH-X: Carbon price effects on Oil & Gas ETF volatility

# Exogenous regressor: EUA carbon price returns
EUA_X <- matrix(returns$EUA_ret, ncol = 1)

# Specify GARCH-X model
spec_garchx <- ugarchspec(
  variance.model = list(
    model = "sGARCH",
    garchOrder = c(1,1),
    external.regressors = EUA_X
  ),
  mean.model = list(armaOrder = c(0,0), include.mean = TRUE),
  distribution.model = "norm"
)

# Fit GARCH-X model
garchx_OIL <- ugarchfit(
  spec = spec_garchx,
  data = returns$OIL_ret
)

# Extract coefficients and standard errors
coefs <- garchx_OIL@fit$matcoef

garchx_coef_table <- as_tibble(coefs, rownames = "Parameter") %>%
  mutate(
    Parameter = recode(
      Parameter,
      mu     = "Mean (μ)",
      omega  = "Constant (ω)",
      alpha1 = "ARCH effect (α)",
      beta1  = "GARCH effect (β)",
      vxreg1 = "Carbon price effect (γ)"
    )
  ) %>%
  mutate(across(where(is.numeric), round, 4))

knitr::kable(
  garchx_coef_table,
  caption = "GARCH-X Coefficient Estimates for Oil & Gas ETF Volatility"
)

```
To test whether carbon prices directly affect risk rather than returns, we estimate a GARCH-X model including EUA returns in the variance equation of the Oil & Gas ETF. While volatility persistence remains extremely high, the coefficient on carbon price returns is not statistically significant. This indicates that daily carbon price movements do not directly drive ETF volatility once standard GARCH dynamics are accounted for. Elevated risk in carbon-intensive assets therefore reflects broader and more persistent sources of uncertainty rather than short-run carbon market shocks.

```{r, GARCH-X Test EUA effect on PA-ETF, cache=TRUE}
# GARCH-X: Carbon price effects on Paris-Aligned ETF volatility

# Exogenous regressor: EUA carbon price returns
EUA_X <- matrix(returns$EUA_ret, ncol = 1)

# Specify GARCH-X model
spec_garchx <- ugarchspec(
  variance.model = list(
    model = "sGARCH",
    garchOrder = c(1,1),
    external.regressors = EUA_X
  ),
  mean.model = list(armaOrder = c(0,0), include.mean = TRUE),
  distribution.model = "norm"
)

# Fit GARCH-X model
garchx_PA <- ugarchfit(
  spec = spec_garchx,
  data = returns$PA_ret
)

# Extract coefficient matrix
coefs_pa <- garchx_PA@fit$matcoef

# Build tidy results table
garchx_coef_table_pa <- as_tibble(coefs_pa, rownames = "Parameter") %>%
  mutate(
    Parameter = recode(
      Parameter,
      mu     = "Mean (μ)",
      omega  = "Constant (ω)",
      alpha1 = "ARCH effect (α)",
      beta1  = "GARCH effect (β)",
      vxreg1 = "Carbon price effect (γ)"
    )
  ) %>%
  mutate(across(where(is.numeric), round, 4))

# Display table
knitr::kable(
  garchx_coef_table_pa,
  caption = "GARCH-X Coefficient Estimates for Paris-Aligned ETF Volatility"
)

```

We estimate a GARCH-X model for the Paris-Aligned ETF to test whether EUA carbon price returns directly affect volatility. The results confirm significant ARCH and GARCH effects, indicating volatility clustering and moderate persistence (α + β ≈ 0.89).

However, the coefficient on carbon price returns is statistically insignificant (p ≈ 0.97) and close to zero. This suggests that short-term carbon price movements do not directly influence the volatility of the Paris-Aligned ETF once standard GARCH dynamics are accounted for.

Overall, the volatility of sustainable assets appears largely insulated from carbon market fluctuations, supporting the view that Paris-Aligned ETFs are less exposed to carbon-related regulatory and transition risk than carbon-intensive assets.

# 9 Conclusion
This study examined whether changes in EU ETS carbon allowance prices affect the returns and volatility of sustainable and carbon-intensive ETFs. Using daily data, we combined correlation analysis, Granger causality tests, impulse response functions, and GARCH-type volatility models to distinguish between effects on expected returns and effects on risk.

The results show no evidence of lagged causal effects from carbon price returns to ETF returns for either the Paris-Aligned ETF or the Oil & Gas ETF. Both ETFs exhibit significant instantaneous causality with EUA returns, indicating that carbon and equity markets respond contemporaneously to common shocks rather than through delayed transmission. Impulse response functions confirm that carbon price shocks do not generate persistent or statistically significant responses in ETF returns.

Volatility analysis reveals strong volatility clustering across all assets. Standard GARCH models show that the Oil & Gas ETF exhibits extremely high volatility persistence, while the Paris-Aligned ETF displays lower and more rapidly decaying risk. However, GARCH-X models including EUA returns as an exogenous variance driver find no statistically significant direct effect of carbon price movements on ETF volatility. Elevated risk in carbon-intensive assets therefore appears to reflect broader macroeconomic, regulatory, and energy-market uncertainty rather than short-run carbon price shocks.

Overall, the findings suggest that EU ETS carbon prices act primarily as a coincident indicator rather than a leading driver of ETF returns or volatility at the daily frequency. Sustainable assets appear relatively insulated from carbon market fluctuations, while carbon-intensive assets exhibit higher and more persistent risk, but not directly attributable to daily carbon price changes.

## 9.1 Limitations and Further Research

Several limitations should be acknowledged. First, the analyzed ETFs are broad and diversified, meaning their returns and volatility are strongly influenced by general equity market movements. This may obscure more granular carbon price effects that could be detectable at the level of individual firms, sector-specific portfolios, or narrower industry ETFs.

Second, the analysis relies on daily data, which may be too high-frequency to capture the gradual transmission of regulatory and transition risk. Carbon pricing effects may materialize over longer horizons, suggesting that weekly or monthly data, or long-run cointegration frameworks, could provide additional insights.

Third, the GARCH-X specification includes only contemporaneous carbon price returns. Future research could explore lagged volatility spillovers, regime-switching volatility models, or multivariate GARCH frameworks to better capture cross-market risk transmission.

Extending the analysis to single stocks, carbon-intensive sub-industries, or event-based approaches around major EU ETS policy announcements may help identify more direct channels through which carbon pricing influences financial markets.
